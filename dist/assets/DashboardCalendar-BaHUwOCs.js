import{r as p,j as t}from"./react-C1G-q6RG.js";import{l as R,m as I}from"./icons-CTQcQIqG.js";const W={personal:"개인",club:"동아리",event:"행사",class:"수업"},P={yoga:"요가",pilates:"필라테스",fitness:"피트니스",dance:"댄스",badminton:"배드민턴",pickleball:"피클볼"},S={personal:{bg:"bg-blue-100",text:"text-blue-800",border:"border-l-4 border-blue-500"},club:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-l-4 border-yellow-500"},event:{bg:"bg-purple-100",text:"text-purple-800",border:"border-l-4 border-purple-500"},class:{bg:"bg-red-100",text:"text-red-800",border:"border-l-4 border-red-500"}},v={yoga:{bg:"bg-emerald-100",text:"text-emerald-800",border:"border-l-4 border-emerald-500"},pilates:{bg:"bg-sky-100",text:"text-sky-800",border:"border-l-4 border-sky-500"},fitness:{bg:"bg-rose-100",text:"text-rose-800",border:"border-l-4 border-rose-500"},dance:{bg:"bg-fuchsia-100",text:"text-fuchsia-800",border:"border-l-4 border-fuchsia-500"},badminton:{bg:"bg-teal-100",text:"text-teal-800",border:"border-l-4 border-teal-500"},pickleball:{bg:"bg-indigo-100",text:"text-indigo-800",border:"border-l-4 border-indigo-500"}},D=["일","월","화","수","목","금","토"],H=({bookings:f,programs:j,view:i,setView:m})=>{const[l,C]=p.useState(new Date),[x,y]=p.useState("all"),N=p.useMemo(()=>{const a=[];return f.filter(e=>e.status==="approved").forEach(e=>{const o=new Date(e.startDate+"T00:00:00"),d=new Date(e.endDate+"T00:00:00");for(let s=new Date(o);s<=d;s.setDate(s.getDate()+1))if(!e.recurrenceRule||e.recurrenceRule.days.length===0||e.recurrenceRule.days.includes(s.getDay())){const r=s.toISOString().split("T")[0];a.push({id:`booking-${e.id}-${r}`,title:e.purpose,startTime:e.startTime,endTime:e.endTime,date:r,type:"booking",originalData:e})}}),j.forEach(e=>{const o=new Date(e.startDate+"T00:00:00"),d=new Date(e.endDate+"T00:00:00");for(let s=new Date(o);s<=d;s.setDate(s.getDate()+1))if(e.scheduleDays.includes(s.getDay())){const c=s.toISOString().split("T")[0];a.push({id:`program-${e.id}-${c}`,title:e.title,startTime:e.startTime,endTime:e.endTime,date:c,type:"program",originalData:e})}}),a.filter(e=>x==="all"?!0:e.type===x)},[f,j,x]),$=a=>{const e=new Date(l);i==="month"?e.setMonth(e.getMonth()+a):i==="week"?e.setDate(e.getDate()+a*7):i==="day"&&e.setDate(e.getDate()+a),C(e)},w=a=>{const e=new Date(a);return e.setDate(e.getDate()-e.getDay()),Array.from({length:7},(o,d)=>{const s=new Date(e);return s.setDate(s.getDate()+d),s})},T=a=>{if(a.type==="booking"){const e=a.originalData;return`[대관 상세]
- 종류: ${W[e.category]}${e.organization?`
- 기관: ${e.organization}`:""}
- 목적: ${e.purpose}
- 시간: ${e.startTime} - ${e.endTime}
- 신청자: ${e.userName}`}else{const e=a.originalData;return`[프로그램 상세]
- 종류: ${P[e.category]}
- 프로그램명: ${e.title}
- 강사: ${e.instructor}
- 시간: ${e.startTime} - ${e.endTime}`}},M=()=>{const a=l.getFullYear(),e=l.getMonth(),o=new Date(a,e,1),d=new Date(a,e+1,0).getDate(),s=o.getDay(),c=[];for(let r=0;r<s;r++)c.push({key:`pad-${r}`,isPadding:!0});for(let r=1;r<=d;r++){const n=`${a}-${String(e+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`,g=N.filter(b=>b.date===n).sort((b,h)=>b.startTime.localeCompare(h.startTime));c.push({key:`day-${r}`,isPadding:!1,day:r,isToday:new Date(n).toDateString()===new Date().toDateString(),eventsForDay:g})}return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-7 text-center",children:D.map(r=>t.jsx("div",{className:"text-xs font-semibold text-gray-500 py-2.5",children:r},r))}),t.jsx("div",{className:"grid grid-cols-7 border-t border-l border-gray-200",style:{minHeight:"60vh"},children:c.map(r=>r.isPadding?t.jsx("div",{className:"border-r border-b border-gray-200"},r.key):t.jsxs("div",{className:`border-r border-b border-gray-200 p-2 flex flex-col ${r.isToday?"bg-blue-50":""}`,children:[t.jsx("span",{className:`text-sm font-medium text-right ${r.isToday?"text-blue-600":"text-gray-800"}`,children:r.day}),t.jsx("div",{className:"mt-1 space-y-1 overflow-y-auto",children:r.eventsForDay.map(n=>{const g=n.type==="booking"?S[n.originalData.category]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-l-4 border-gray-500"}:v[n.originalData.category]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-l-4 border-gray-500"};return t.jsxs("div",{className:`${g.bg} ${g.text} ${g.border} text-xs rounded p-1.5 cursor-pointer`,title:T(n),children:[t.jsx("p",{className:"font-semibold truncate",children:n.title}),t.jsxs("p",{className:"truncate",children:[n.startTime,"-",n.endTime]})]},n.id)})})]},r.key))})]})},k=a=>{const e=Array.from({length:24},(o,d)=>`${String(d).padStart(2,"0")}:00`);return t.jsxs("div",{className:"flex border-t border-gray-200",children:[t.jsxs("div",{className:"w-16 border-r border-gray-200",children:[t.jsx("div",{className:"h-12 border-b border-gray-200"}),e.map(o=>t.jsx("div",{className:"h-12 border-b border-gray-200 text-center text-xs text-gray-500 pt-1",children:o},o))]}),t.jsx("div",{className:"flex-1 grid",style:{gridTemplateColumns:`repeat(${a.length}, 1fr)`},children:a.map((o,d)=>{const s=o.toISOString().split("T")[0],c=N.filter(r=>r.date===s);return t.jsxs("div",{className:`relative ${d<a.length-1?"border-r":""} border-gray-200`,children:[e.map(r=>t.jsx("div",{className:"h-12 border-b border-gray-200"},r)),c.map(r=>{const n=r.startTime.split(":").map(Number),g=r.endTime.split(":").map(Number),b=(n[0]*60+n[1])/60*3,h=(g[0]*60+g[1]-(n[0]*60+n[1]))/60*3,u=r.type==="booking"?S[r.originalData.category]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-l-4 border-gray-500"}:v[r.originalData.category]||{bg:"bg-gray-100",text:"text-gray-800",border:"border-l-4 border-gray-500"};return t.jsxs("div",{style:{top:`calc(3rem + ${b}rem)`,height:`${h}rem`},className:`absolute left-1 right-1 ${u.bg} ${u.text} ${u.border} p-2 rounded-lg text-xs overflow-hidden`,title:T(r),children:[t.jsx("p",{className:"font-bold",children:r.title}),t.jsxs("p",{children:[r.startTime,"-",r.endTime]})]},r.id)})]},d)})})]})},F=()=>{const a=w(l);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid",style:{gridTemplateColumns:"4rem 1fr"},children:[t.jsx("div",{className:"w-16"}),t.jsx("div",{className:"grid grid-cols-7 text-center",children:a.map((e,o)=>t.jsxs("div",{className:"py-2 border-b border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500",children:D[e.getDay()]}),t.jsx("p",{className:`text-xl font-medium ${e.toDateString()===new Date().toDateString()?"text-blue-600":"text-gray-800"}`,children:e.getDate()})]},o))})]}),k(a)]})},E=()=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid",style:{gridTemplateColumns:"4rem 1fr"},children:[t.jsx("div",{className:"w-16"}),t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"py-2 border-b border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500",children:D[l.getDay()]}),t.jsx("p",{className:`text-xl font-medium ${l.toDateString()===new Date().toDateString()?"text-blue-600":"text-gray-800"}`,children:l.getDate()})]})})]}),k([l])]}),O=()=>{const a=l.getFullYear(),e=l.getMonth();if(i==="month")return`${a}년 ${e+1}월`;if(i==="week"){const o=w(l);return`${a}년 ${e+1}월 ${o[0].getDate()}일 - ${o[6].getDate()}일`}return`${a}년 ${e+1}월 ${l.getDate()}일`};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-4 gap-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>$(-1),"aria-label":"이전",className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:t.jsx(R,{className:"w-5 h-5 text-gray-600"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 w-40 sm:w-52 text-center",children:O()}),t.jsx("button",{onClick:()=>$(1),"aria-label":"다음",className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:t.jsx(I,{className:"w-5 h-5 text-gray-600"})})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center bg-gray-100 p-1 rounded-xl",children:[t.jsx("button",{onClick:()=>y("all"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${x==="all"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-white/60"}`,children:"전체"}),t.jsx("button",{onClick:()=>y("booking"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${x==="booking"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-white/60"}`,children:"대관"}),t.jsx("button",{onClick:()=>y("program"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${x==="program"?"bg-white text-emerald-600 shadow-sm":"text-gray-600 hover:bg-white/60"}`,children:"프로그램"})]}),t.jsxs("div",{className:"flex items-center bg-gray-100 p-1 rounded-xl",children:[t.jsx("button",{onClick:()=>m("month"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${i==="month"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:"월"}),t.jsx("button",{onClick:()=>m("week"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${i==="week"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:"주"}),t.jsx("button",{onClick:()=>m("day"),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${i==="day"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:"일"})]})]})]}),i==="month"&&M(),i==="week"&&F(),i==="day"&&E()]})};export{H as default};
