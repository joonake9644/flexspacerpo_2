import{r as d,j as e}from"./react-C1G-q6RG.js";import{b as k,d as x}from"./index-VDPl71_X.js";import{H as C,m as p,I as P,J as M,w as S}from"./firebase-CpY9aKCX.js";import{r as O,s as F,t as E}from"./icons-DJqNYe3e.js";const R=()=>{const{facilities:h}=k(),[b,i]=d.useState(!1),[l,c]=d.useState(null),m={name:"",type:"gym",capacity:1,bufferMinutes:0,bookingPolicy:{allowOverlap:!1,maxConcurrent:1,timeSlotMinutes:60}},[s,r]=d.useState(m),g=()=>{c(null),r(m),i(!0)},y=t=>{c(t),r({...t,bookingPolicy:t.bookingPolicy||{allowOverlap:!1,maxConcurrent:1,timeSlotMinutes:60}}),i(!0)},u=()=>{i(!1),c(null)},n=t=>{const{name:a,value:o,type:w}=t.target,N=w==="number";r(v=>({...v,[a]:N?Number(o):o}))},f=async t=>{if(t.preventDefault(),!s.name||s.capacity<=0){alert("시설 이름과 수용 인원을 확인해주세요.");return}try{if(l){const a=p(x,"facilities",l.id);await P(a,s),alert("시설 정보가 성공적으로 수정되었습니다.")}else await M(S(x,"facilities"),s),alert("새 시설이 추가되었습니다.");u()}catch(a){console.error("Error saving facility: ",a),alert("처리 중 오류가 발생했습니다.")}},j=async t=>{if(window.confirm("정말로 이 시설을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."))try{await C(p(x,"facilities",t)),alert("시설이 삭제되었습니다.")}catch(a){console.error("Error deleting facility: ",a),alert("삭제 중 오류가 발생했습니다.")}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"시설 관리"}),e.jsx("p",{className:"text-gray-600",children:"체육관 시설을 추가, 수정, 삭제합니다."})]}),e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 transition-all duration-300 font-medium shadow hover:shadow-lg hover:-translate-y-0.5",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"새 시설 추가"})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"이름"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"종류"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"수용 인원"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"버퍼(분)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"중복 정책"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(t=>{const a=t.bookingPolicy,o=a?.allowOverlap?`🔄 중복허용 (최대${a.maxConcurrent||1}팀)`:"🚫 단독사용";return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.capacity}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.bufferMinutes}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a?.allowOverlap?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:o})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>y(t),className:"p-2 text-gray-500 hover:text-blue-600 rounded-lg transition-all hover:scale-110",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(t.id),className:"p-2 text-gray-500 hover:text-red-600 rounded-lg transition-all hover:scale-110",children:e.jsx(E,{className:"w-4 h-4"})})]})]},t.id)})})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:l?"시설 정보 수정":"새 시설 추가"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"시설 이름"}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:n,required:!0,className:"w-full p-3 border border-gray-200 rounded-xl"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"수용 인원"}),e.jsx("input",{type:"number",name:"capacity",value:s.capacity,onChange:n,required:!0,min:1,className:"w-full p-3 border border-gray-200 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"버퍼 시간 (분)"}),e.jsx("input",{type:"number",name:"bufferMinutes",value:s.bufferMinutes,onChange:n,required:!0,min:0,className:"w-full p-3 border border-gray-200 rounded-xl"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"시설 종류"}),e.jsxs("select",{name:"type",value:s.type,onChange:n,className:"w-full p-3 border border-gray-200 rounded-xl bg-white",children:[e.jsx("option",{value:"gym",children:"체육관"}),e.jsx("option",{value:"court",children:"코트"}),e.jsx("option",{value:"field",children:"운동장"}),e.jsx("option",{value:"pool",children:"수영장"}),e.jsx("option",{value:"room",children:"다목적실"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"중복 사용 설정"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:s.bookingPolicy?.allowOverlap||!1,onChange:t=>r(a=>({...a,bookingPolicy:{...a.bookingPolicy,allowOverlap:t.target.checked,maxConcurrent:t.target.checked?a.bookingPolicy?.maxConcurrent||2:1}})),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"중복 사용 허용 (같은 시간에 여러 팀 사용 가능)"})]}),s.bookingPolicy?.allowOverlap&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"최대 동시 사용 팀"}),e.jsx("input",{type:"number",min:"2",max:"10",value:s.bookingPolicy?.maxConcurrent||2,onChange:t=>r(a=>({...a,bookingPolicy:{...a.bookingPolicy,maxConcurrent:parseInt(t.target.value)}})),className:"w-full p-3 border border-gray-200 rounded-xl"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"같은 시간에 이용할 수 있는 최대 팀 수"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:u,className:"flex-1 py-3 px-4 border rounded-xl hover:bg-gray-50 font-medium transition-colors",children:"취소"}),e.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 font-medium transition-colors",children:l?"수정하기":"추가하기"})]})]})]})})]})};export{R as default};
