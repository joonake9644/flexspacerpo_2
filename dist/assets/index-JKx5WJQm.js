const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DashboardCalendar-DPNPSWad.js","./react-C1G-q6RG.js","./icons-DJqNYe3e.js","./LoginForm-DLgMn50m.js","./firebase-CVBrtIcl.js","./Navigation-8bv2TbVd.js","./BookingSection-BonstKOK.js","./firebase-functions-ekMhbLJx.js","./ProgramSection-BZvC57Jo.js","./AdminSection-DicbOWh7.js","./UserManagement-DbZXPRkf.js","./FacilityManagement-Cbd65KMP.js"])))=>i.map(i=>d[i]);
import{r as i,j as e,R as de,a as ue}from"./react-C1G-q6RG.js";import{g as K,i as me,a as he,b as ge,c as xe,d as fe,e as pe,f as we,h as ye,j as je,o as be,s as X,k as V,l as L,m as B,n as R,p as Ne,u as Q,q as I,r as C,G as ve,t as Ee,v as O,w as M,x as z,y as G}from"./firebase-CVBrtIcl.js";import{C as q,U as Z,B as H,a as W,X as Ae,I as _e,T as De,b as Se,c as Pe}from"./icons-DJqNYe3e.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const m of l)if(m.type==="childList")for(const f of m.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function o(l){const m={};return l.integrity&&(m.integrity=l.integrity),l.referrerPolicy&&(m.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?m.credentials="include":l.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(l){if(l.ep)return;l.ep=!0;const m=o(l);fetch(l.href,m)}})();const Te="modulepreload",Ce=function(s,n){return new URL(s,n).href},U={},P=function(n,o,c){let l=Promise.resolve();if(o&&o.length>0){let v=function(p){return Promise.all(p.map(j=>Promise.resolve(j).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};const f=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),y=u?.nonce||u?.getAttribute("nonce");l=v(o.map(p=>{if(p=Ce(p,c),p in U)return;U[p]=!0;const j=p.endsWith(".css"),E=j?'[rel="stylesheet"]':"";if(!!c)for(let r=f.length-1;r>=0;r--){const h=f[r];if(h.href===p&&(!j||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${E}`))return;const a=document.createElement("link");if(a.rel=j?"stylesheet":Te,j||(a.as="script"),a.crossOrigin="",a.href=p,y&&a.setAttribute("nonce",y),document.head.appendChild(a),j)return new Promise((r,h)=>{a.addEventListener("load",r),a.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${p}`)))})}))}function m(f){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=f,window.dispatchEvent(u),!u.defaultPrevented)throw f}return l.then(f=>{for(const u of f||[])u.status==="rejected"&&m(u.reason);return n().catch(m)})},k={},Le={apiKey:"AIzaSyBvlPy3BOyrRCokGAHkzuX6IoVZNjWTU-0",authDomain:"flexspaceprowin.firebaseapp.com",projectId:"flexspaceprowin",storageBucket:"flexspaceprowin.firebasestorage.app",messagingSenderId:"545144229496",appId:"1:545144229496:web:a833b961cf4b8a7ce9678d",measurementId:"G-D81Q76VKZQ"},$=K().length?K()[0]:me(Le),b=he($),_=ge($),se=xe($),Re=k?.VITE_USE_EMULATOR==="true";if(Re){const s=k?.VITE_EMULATOR_HOST||"127.0.0.1",n=Number(k?.VITE_EMULATOR_AUTH_PORT||9099),o=Number(k?.VITE_EMULATOR_FIRESTORE_PORT||8080),c=Number(k?.VITE_EMULATOR_STORAGE_PORT||9199);try{fe(b,`http://${s}:${n}`,{disableWarnings:!0})}catch{}try{pe(_,s,o)}catch{}try{we(se,s,c)}catch{}}ye().then(s=>s?je($):null).catch(()=>null);const tt=Object.freeze(Object.defineProperty({__proto__:null,auth:b,db:_,default:$,storage:se},Symbol.toStringTag,{value:"Module"})),Ie=()=>{const[s,n]=i.useState(null),[o,c]=i.useState(!1),[l,m]=i.useState(!0);i.useEffect(()=>{m(!0);const t=be(b,async a=>{try{if(!a){n(null),c(!1);return}c(a.emailVerified);const r=L(_,"users",a.uid),h=await V(r);let N="user",w=a.displayName||(a.email?.split("@")[0]??"user"),g;if(h.exists()){const d=h.data();N=d.role||"user",w=d.name||w,g=d.phone}else{const d={name:w,email:a.email??"",phone:null,role:"user",isActive:!0,createdAt:C(),updatedAt:C()};await I(r,d),console.log("새 사용자 정보를 users 컬렉션에 추가:",a.uid)}n({id:a.uid,name:w,email:a.email??"",phone:g,role:N})}catch(r){console.error("Auth state change error:",r),a&&n({id:a.uid,name:a.email?.split("@")[0]??"user",email:a.email??"",role:"user"})}finally{m(!1)}});return()=>t()},[]);const f=i.useCallback(async(t,a)=>{try{const r=await X(b,t,a),h=await V(L(_,"users",r.user.uid)),w=(h.exists()?h.data():null)?.adminCreated===!0;if(!r.user.emailVerified&&!w){try{await B(r.user,{url:`${window.location.origin}/`,handleCodeInApp:!1})}catch(g){console.warn("이메일 인증 재전송 실패:",g)}throw await R(b),new Error("이메일 인증이 필요합니다. 새로운 인증 메일을 발송했습니다. 이메일함을 확인해주세요.")}return!0}catch(r){throw console.error("Login error:",r),r}},[]),u=i.useCallback(async(t,a)=>{try{const r=await X(b,t,a);if(!(t==="admin@flexspace.test"||t==="flexadmin@test.com"||t==="joonake@naver.com"||t==="uu@naver.com")&&!r.user.emailVerified){try{await B(r.user,{url:`${window.location.origin}/`,handleCodeInApp:!1})}catch(A){console.warn("관리자 이메일 인증 재전송 실패:",A)}throw await R(b),new Error("이메일 인증이 필요합니다. 새로운 인증 메일을 발송했습니다. 이메일함을 확인해주세요.")}const N=L(_,"users",r.user.uid),w=await V(N),g=w.exists()?w.data():{},d=g.role;if(console.log("Admin login - User data:",{uid:r.user.uid,email:r.user.email,firestoreExists:w.exists(),role:d,allData:g}),d!=="admin")throw await R(b),new Error(`관리자 권한이 없습니다. 현재 권한: ${d||"없음"}`);return!0}catch(r){throw console.error("Admin login error:",r),r}},[]),y=i.useCallback(async t=>{try{const{name:a,email:r,phone:h,password:N}=t;if(!r||!N)throw new Error("이메일과 비밀번호가 필요합니다.");if(N.length<6)throw new Error("비밀번호는 6자 이상이어야 합니다.");const w=await Ne(b,r,N);await Q(w.user,{displayName:a||r.split("@")[0]});const g=L(_,"users",w.user.uid);await I(g,{name:a||(r.split("@")[0]??"user"),email:r,phone:h||null,role:"user",isActive:!0,createdAt:C(),updatedAt:C()},{merge:!0});try{await B(w.user,{url:`${window.location.origin}/`,handleCodeInApp:!1}),console.log("이메일 인증 메일 전송 성공:",r)}catch(d){console.warn("이메일 인증 메일 전송 실패:",d)}return await R(b),!0}catch(a){throw console.error("Signup error:",a),a}},[]),v=i.useCallback(async()=>{try{const t=new ve;t.addScope("email"),t.addScope("profile"),t.setCustomParameters({prompt:"select_account"});const r=(await Ee(b,t)).user;if(console.log("Google login success:",{uid:r.uid,email:r.email,displayName:r.displayName,emailVerified:r.emailVerified}),!r.email)throw new Error("Google 계정에서 이메일 정보를 가져올 수 없습니다.");const h=L(_,"users",r.uid);let N={name:r.displayName||r.email.split("@")[0]||"user",email:r.email,phone:r.phoneNumber||null,role:"user",isActive:!0,updatedAt:C()};try{(await V(h)).exists()?(await I(h,N,{merge:!0}),console.log("Google 로그인: 기존 사용자 정보 업데이트됨:",r.uid)):(await I(h,{...N,createdAt:C()}),console.log("Google 로그인: 새 사용자 정보 저장됨:",r.uid))}catch(w){console.warn("Firestore 저장 실패, 하지만 로그인은 계속 진행:",w)}return!0}catch(t){throw console.error("Google login error:",t),t.code==="auth/popup-closed-by-user"||t.code==="auth/cancelled-popup-request"?new Error("Google 로그인이 취소되었습니다."):t.code==="auth/popup-blocked"?new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요."):t.code==="auth/network-request-failed"?new Error("네트워크 연결을 확인해주세요."):new Error(`Google 로그인 실패: ${t.message||"알 수 없는 오류"}`)}},[]),p=i.useCallback(async()=>{if(b.currentUser)return await B(b.currentUser),!0;throw new Error("로그인이 필요합니다.")},[]),j=i.useCallback(async(t,a)=>{if(b.currentUser){await Q(b.currentUser,{displayName:t,photoURL:a});const r=L(_,"users",b.currentUser.uid);return await I(r,{name:t||b.currentUser.displayName,updatedAt:C()},{merge:!0}),!0}throw new Error("로그인이 필요합니다.")},[]),E=i.useCallback(async()=>{await R(b),n(null),c(!1)},[]);return i.useMemo(()=>({user:s,login:f,logout:E,signup:y,adminLogin:u,googleLogin:v,sendVerificationEmail:p,updateUserProfile:j,emailVerified:o,loading:l}),[s,f,E,y,u,v,p,j,o,l])},re=()=>{const[s,n]=i.useState(!0),[o,c]=i.useState(!1),l=i.useRef(null),[m,f]=i.useState([]),[u,y]=i.useState([]),[v,p]=i.useState([]),[j,E]=i.useState([]),[t,a]=i.useState([]),r=()=>{c(!0),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{c(!1)},500)};return i.useEffect(()=>{const h=[];let N=0;const w=5,g=()=>{N++,N>=w&&n(!1)};return h.push(O(M(_,"users"),d=>{const A=d.docs.map(x=>({id:x.id,...x.data()}));E(x=>(x.length>0&&r(),A)),g()},d=>{console.error("Error fetching users:",d),g()})),h.push(O(z(M(_,"bookings"),G("createdAt","desc")),d=>{const A=d.docs.map(x=>({id:x.id,...x.data()}));f(x=>(x.length>0&&r(),A)),g()},d=>{console.error("Error fetching bookings:",d),g()})),h.push(O(z(M(_,"programs"),G("startDate","asc")),d=>{const A=d.docs.map(x=>({id:x.id,...x.data()}));y(x=>(x.length>0&&r(),A)),g()},d=>{console.error("Error fetching programs:",d),g()})),h.push(O(z(M(_,"applications"),G("appliedAt","desc")),d=>{const A=d.docs.map(x=>({id:x.id,...x.data()}));p(x=>(x.length>0&&r(),A)),g()},d=>{console.error("Error fetching applications:",d),g()})),h.push(O(M(_,"facilities"),d=>{const A=d.docs.map(x=>({id:x.id,...x.data()}));a(x=>(x.length>0&&r(),A)),g()},d=>{console.error("Error fetching facilities:",d),g()})),()=>{h.forEach(d=>d()),l.current&&clearTimeout(l.current)}},[]),i.useMemo(()=>({loading:s,syncing:o,bookings:m,setBookings:f,programs:u,setPrograms:y,applications:v,setApplications:p,users:j,setUsers:E,facilities:t}),[s,o,m,u,v,j,t])},st=s=>{const n=s.replace(/\D/g,"");return n.length<=3?n:n.length<=7?`${n.slice(0,3)}-${n.slice(3)}`:`${n.slice(0,3)}-${n.slice(3,7)}-${n.slice(7,11)}`},J=s=>({"auth/user-not-found":"미가입자입니다. 회원가입을 해주세요.","auth/wrong-password":"비밀번호가 일치하지 않습니다.","auth/email-already-in-use":"이미 사용 중인 이메일입니다.","auth/weak-password":"비밀번호가 너무 간단합니다. 6자 이상 입력해주세요.","auth/invalid-email":"올바른 이메일 형식이 아닙니다.","auth/invalid-credential":"이메일 또는 비밀번호가 잘못되었습니다. 미가입자는 회원가입을 먼저 해주세요.","auth/invalid-login-credentials":"로그인 정보가 잘못되었습니다. 미가입자는 회원가입을 먼저 해주세요.","auth/too-many-requests":"로그인 시도가 너무 많습니다. 잠시 후 다시 시도하거나 브라우저 캐시를 삭제해 주세요.","firestore/permission-denied":"접근 권한이 없습니다.","firestore/unavailable":"서비스가 일시적으로 사용 불가합니다.","firestore/deadline-exceeded":"요청 시간이 초과되었습니다.","storage/unauthorized":"파일 업로드 권한이 없습니다.","storage/object-not-found":"파일을 찾을 수 없습니다.","storage/quota-exceeded":"저장소 용량이 초과되었습니다.","functions/permission-denied":"함수 실행 권한이 없습니다.","functions/unavailable":"서버 함수가 일시적으로 사용 불가합니다."})[s]||"로그인에 실패했습니다. 이메일/비밀번호를 확인하거나 회원가입을 먼저 진행해주세요.",F=s=>{const n=s instanceof Error?s.message:String(s),o=n.match(/auth\/([\w-]+)/);return o&&o[0]?J(o[0]):J(n)},Oe=i.lazy(()=>P(()=>import("./DashboardCalendar-DPNPSWad.js"),__vite__mapDeps([0,1,2]),import.meta.url)),Me=s=>{const n=new Date;n.setHours(0,0,0,0);const o=new Date(s.startDate);o.setHours(0,0,0,0);const c=new Date(s.endDate);return c.setHours(0,0,0,0),n>c?{text:"종료",dDay:null}:n>=o&&n<=c?{text:"진행중",dDay:null}:{text:"모집중",dDay:Math.ceil((o.getTime()-n.getTime())/(1e3*60*60*24))}},Y=({status:s})=>{const n={approved:{text:"승인됨 / Approved",color:"bg-green-100 text-green-800"},pending:{text:"대기중 / Pending",color:"bg-orange-100 text-orange-800"},rejected:{text:"거절됨 / Rejected",color:"bg-red-100 text-red-800"},completed:{text:"종료 / Ended",color:"bg-gray-100 text-gray-800"},cancelled:{text:"취소됨 / Cancelled",color:"bg-gray-100 text-gray-800"}},{text:o,color:c}=n[s];return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c}`,children:o})},ae=["일","월","화","수","목","금","토"],ke=s=>{const{startDate:n,endDate:o,recurrenceRule:c}=s;if(n===o)return n;let l="";return c&&c.days.length>0&&(l=` (매주 / Every ${c.days.sort().map(m=>ae[m]).join(", ")})`),`${n} ~ ${o}${l}`},$e=s=>`${s.scheduleDays.sort().map(o=>ae[o]).join(",")} ${s.startTime}-${s.endTime}`,ee=({currentUser:s,bookings:n=[],applications:o=[],programs:c=[],setActiveTab:l,syncing:m=!1})=>{const{users:f}=re(),u=i.useMemo(()=>n.filter(t=>t.userId===s.id).sort((t,a)=>new Date(a.startDate).getTime()-new Date(t.startDate).getTime()),[n,s.id]),y=i.useMemo(()=>o.filter(t=>t.userId===s.id).sort((t,a)=>{const r=t.appliedAt?.toDate?t.appliedAt.toDate():new Date(t.appliedAt||0);return(a.appliedAt?.toDate?a.appliedAt.toDate():new Date(a.appliedAt||0)).getTime()-r.getTime()}),[o,s.id]),v=i.useMemo(()=>n.filter(t=>t.status==="pending"),[n]),p=i.useMemo(()=>o.filter(t=>t.status==="pending"),[o]),[j,E]=i.useState("month");return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.role==="admin"?"관리자 대시보드 / Admin Dashboard":"마이 대시보드 / My Dashboard"}),e.jsx("p",{className:"text-gray-600",children:s.role==="admin"?"체육관 운영 현황을 한눈에 확인하세요 / Check gym operational status at a glance":"나의 예약과 프로그램 신청 현황입니다 / View your booking and program application status"})]}),m&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"동기화 중..."})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:s.role==="admin"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"대기중인 대관 / Pending Bookings"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:v.length})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"대기중인 프로그램 신청 / Pending Applications"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:p.length})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"운영중인 프로그램 / Active Programs"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:c.filter(t=>{const a=new Date;return new Date(t.endDate)>=a}).length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"총 이용자 수 / Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:f.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:e.jsx(W,{className:"w-6 h-6 text-blue-600"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"나의 대관 / My Bookings"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:u.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"나의 프로그램 신청 / My Applications"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:y.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"운영중인 프로그램 / Active Programs"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:c.length})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"최근 대관 신청 / Recent Bookings"}),e.jsxs("div",{className:"space-y-4",children:[(s.role==="admin"?n.slice(0,3):u.slice(0,3)).map(t=>e.jsx("div",{className:"p-4 bg-gray-50 rounded-xl transition-colors duration-200 hover:bg-gray-100 border-l-4 border-blue-500",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.purpose}),e.jsx(Y,{status:t.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),t.organization&&`${t.organization} | `,ke(t)," ",t.startTime,"-",t.endTime]}),s.role==="admin"&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"신청자: ",t.userName," (",t.userEmail,")"]}),e.jsxs("p",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(H,{className:"w-4 h-4"}),t.category==="class"?"수업":t.category==="event"?"행사":t.category==="personal"?"개인":"동아리"," | ",t.numberOfParticipants,"명"]})]})]})})},t.id)),(s.role==="admin"?n:u).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"대관 신청 내역이 없습니다."})]}),(s.role==="admin"?n:u).length>3&&e.jsx("button",{onClick:()=>l("booking"),className:"w-full mt-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"전체 보기"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s.role==="admin"?"프로그램 신청 현황 / Program Applications":"내 프로그램 / My Programs"}),e.jsxs("div",{className:"space-y-4",children:[(s.role==="admin"?o.slice(0,3):y.slice(0,3)).map(t=>{const a=c.find(h=>h.id===t.programId),r=a?Me(a):null;return e.jsx("div",{className:"p-4 bg-gray-50 rounded-xl transition-colors duration-200 hover:bg-gray-100 border-l-4 border-purple-500",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.programTitle}),r&&r.dDay!==null&&e.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-full",children:["D-",r.dDay]}),e.jsx(Y,{status:t.status})]}),a&&e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"강사: ",a.instructor," | 기간: ",a.startDate," ~ ",a.endDate]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"일정: ",$e(a)]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"비용: ",a.fee?`${a.fee.toLocaleString()}원`:"무료"," | 정원: ",a.enrolled??0," / ",a.capacity,"명"]})]}),s.role==="admin"&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"신청자: ",t.userName," | 신청일: ",(t.appliedAt?.toDate?t.appliedAt.toDate():new Date(t.appliedAt||0)).toLocaleDateString()]})]})})},t.id)}),(s.role==="admin"?o:y).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"프로그램 신청 내역이 없습니다."})]}),(s.role==="admin"?o:y).length>3&&e.jsx("button",{onClick:()=>l("program"),className:"w-full mt-4 py-2 text-sm font-medium text-purple-600 hover:text-purple-800 transition-colors",children:"전체 보기"})]})]}),e.jsxs("div",{id:"dashboard-calendar-section",className:"mt-6 bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"전체 일정 캘린더 / Full Schedule Calendar"}),e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"text-gray-500",children:"캘린더 로딩 중..."}),children:e.jsx(Oe,{bookings:s.role==="admin"?n:u,programs:c,view:j,setView:E})})]})]})},ne=i.createContext(void 0),Ve=({children:s})=>{const[n,o]=i.useState([]),c=i.useCallback(m=>{o(f=>f.filter(u=>u.id!==m))},[]),l=i.useCallback((m,f="info",u=5e3)=>{const y=`notification-${Date.now()}-${Math.random()}`,v={id:y,message:m,type:f,duration:u};o(p=>[...p,v]),u>0&&setTimeout(()=>{c(y)},u)},[c]);return e.jsx(ne.Provider,{value:{notifications:n,showNotification:l,removeNotification:c},children:s})},Be=()=>{const s=i.useContext(ne);if(s===void 0)throw new Error("useNotification must be used within a NotificationProvider");return s},Fe={success:e.jsx(Pe,{className:"w-6 h-6 text-green-500"}),error:e.jsx(Se,{className:"w-6 h-6 text-red-500"}),warning:e.jsx(De,{className:"w-6 h-6 text-yellow-500"}),info:e.jsx(_e,{className:"w-6 h-6 text-blue-500"})},ze=({notification:s,onRemove:n})=>e.jsx("div",{className:"bg-white rounded-xl shadow-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden mb-4 animate-on-load",style:{animationName:"fadeInRight"},children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:Fe[s.type]}),e.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.message})}),e.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:e.jsxs("button",{onClick:()=>n(s.id),className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(Ae,{className:"h-5 w-5","aria-hidden":"true"})]})})]})})}),Ge=()=>{const{notifications:s,removeNotification:n}=Be();return e.jsx("div",{className:"fixed inset-0 flex items-end justify-end px-4 py-6 pointer-events-none sm:p-6 z-50",children:e.jsx("div",{className:"w-full max-w-sm",children:s.map(o=>e.jsx(ze,{notification:o,onRemove:n},o.id))})})},qe=i.lazy(()=>P(()=>import("./LoginForm-DLgMn50m.js"),__vite__mapDeps([3,1,4,2]),import.meta.url)),He=i.lazy(()=>P(()=>import("./Navigation-8bv2TbVd.js"),__vite__mapDeps([5,1,4,2]),import.meta.url)),We=i.lazy(()=>P(()=>import("./BookingSection-BonstKOK.js"),__vite__mapDeps([6,1,4,7,2]),import.meta.url)),Ke=i.lazy(()=>P(()=>import("./ProgramSection-BZvC57Jo.js"),__vite__mapDeps([8,1,4,7,2]),import.meta.url)),Xe=i.lazy(()=>P(()=>import("./AdminSection-DicbOWh7.js"),__vite__mapDeps([9,1,4,7,2]),import.meta.url)),Qe=i.lazy(()=>P(()=>import("./UserManagement-DbZXPRkf.js"),__vite__mapDeps([10,1,4,2]),import.meta.url)),Ze=i.lazy(()=>P(()=>import("./FacilityManagement-Cbd65KMP.js"),__vite__mapDeps([11,1,4,2]),import.meta.url));function Ue(){const{user:s,login:n,logout:o,signup:c,adminLogin:l,googleLogin:m,loading:f}=Ie(),{loading:u,syncing:y,bookings:v,setBookings:p,programs:j,setPrograms:E,applications:t,setApplications:a,users:r,setUsers:h,facilities:N}=re(),[w,g]=i.useState("dashboard");i.useEffect(()=>{s&&!u&&g("dashboard")},[s,u]);const d=async(D,S)=>{try{if(!D.trim()||!S.trim())throw new Error("이메일과 비밀번호를 입력해주세요.");return await n(D,S),[!0,null]}catch(T){return console.error("Login failed:",T),[!1,F(T)]}},A=async(D,S)=>{try{if(!D.trim()||!S.trim())throw new Error("이메일과 비밀번호를 입력해주세요.");return await l(D,S),[!0,null]}catch(T){return console.error("Admin login failed:",T),[!1,F(T)]}},x=async D=>{try{const{name:S,email:T,password:ce}=D;if(!S?.trim())throw new Error("이름을 입력해주세요.");if(!T?.trim())throw new Error("이메일을 입력해주세요.");if(!ce?.trim())throw new Error("비밀번호를 입력해주세요.");return await c(D),[!0,"회원가입이 완료되었습니다. 이메일 인증을 확인해주세요."]}catch(S){return console.error("Signup failed:",S),[!1,F(S)]}},oe=async()=>{try{return await m(),[!0,null]}catch(D){return console.error("Google login failed:",D),[!1,F(D)]}},ie=async()=>{await o(),g("dashboard")},le=()=>{if(!s)return null;switch(w){case"dashboard":return e.jsx(ee,{currentUser:s,bookings:v,applications:t,programs:j,setActiveTab:g,syncing:y});case"booking":return e.jsx(We,{currentUser:s,bookings:v,setBookings:p,syncing:y});case"program":return e.jsx(Ke,{currentUser:s,programs:j,setPrograms:E,applications:t,setApplications:a});case"admin":return e.jsx(Xe,{currentUser:s,bookings:v,setBookings:p,applications:t,setApplications:a,programs:j,setPrograms:E,users:r,facilities:N});case"userManagement":return e.jsx(Qe,{users:r,setUsers:h});case"facilities":return e.jsx(Ze,{});default:return e.jsx(ee,{currentUser:s,bookings:v,applications:t,programs:j,setActiveTab:g,syncing:y})}};return u||f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{}),e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}),children:s?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(He,{currentUser:s,activeTab:w,setActiveTab:g,onLogout:ie}),e.jsx("main",{children:le()})]}):e.jsx(qe,{onLogin:d,onSignup:x,onAdminLogin:A,onGoogleLogin:oe})})]})}const te=document.getElementById("root");te?de.createRoot(te).render(e.jsx(ue.StrictMode,{children:e.jsx(Ve,{children:e.jsx(Ue,{})})})):console.error("Failed to find the root element");export{P as _,b as a,re as b,$ as c,_ as d,tt as e,st as f,F as g,Be as u};
