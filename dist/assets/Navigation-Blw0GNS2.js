import{r as c,j as e}from"./react-C1G-q6RG.js";import{A as k,B as v}from"./firebase-CpY9aKCX.js";import{e as C,f as $,g as S,a as g,H as p,C as f,B as j,S as w,h as N,X as M,i as O,j as B}from"./icons-DJqNYe3e.js";const P=v();function E(n){const t="=".repeat((4-n.length%4)%4),m=(n+t).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(m),x=new Uint8Array(i.length);for(let o=0;o<i.length;++o)x[o]=i.charCodeAt(o);return x}const I=k(P,"subscribeToPush");function D(){const[n,t]=c.useState(!1),[m,i]=c.useState(!1),[x,o]=c.useState(null),[h,u]=c.useState(null),[b,r]=c.useState(!0);return c.useEffect(()=>{"serviceWorker"in navigator&&"PushManager"in window?(t(!0),navigator.serviceWorker.ready.then(s=>{s.pushManager.getSubscription().then(a=>{a&&(i(!0),o(a)),r(!1)})})):r(!1)},[]),{isSupported:n,isSubscribed:m,subscription:x,subscribe:async()=>{if(!n){u(new Error("?몄떆 ?뚮┝??吏?먮릺吏 ?딅뒗 釉뚮씪?곗??낅땲??"));return}try{const s=await navigator.serviceWorker.register("/sw.js"),a="BPUSPTkxzpJSvhJ4krhwlP0K6U0p_B9xJ3fSgyDWpb4VdbceR571GFI9eOH4tgh4I64IXO9ZywTS4ihtabf1z_8",d=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:E(a)});return await I({subscription:d.toJSON()}),o(d),i(!0),u(null),d}catch(s){throw console.error("?몄떆 援щ룆 ?ㅽ뙣:",s),u(s),s}},error:h,loading:b}}const F=()=>{const{isSubscribed:n,subscribe:t,loading:m,error:i}=D();return m?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 flex items-center",disabled:!0,children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"알림 상태 확인 중..."]}):n?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 flex items-center",disabled:!0,children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"알림이 활성화되었습니다"]}):i?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-700 flex items-center",disabled:!0,children:[e.jsx(XCircle,{className:"w-4 h-4 mr-2"}),"알림을 활성화할 수 없습니다"]}):e.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"알림 활성화하기"]})},J=({currentUser:n,activeTab:t,setActiveTab:m,onLogout:i})=>{const[x,o]=c.useState(!1),[h,u]=c.useState(!1),b=c.useRef(null),r="flex items-center space-x-2 px-3 py-2 rounded-lg transition-all duration-200",l={dashboard:"bg-blue-50 text-blue-600 font-semibold",booking:"bg-blue-50 text-blue-600 font-semibold",program:"bg-purple-50 text-purple-600 font-semibold",admin:"bg-green-50 text-green-600 font-semibold",userManagement:"bg-yellow-50 text-yellow-700 font-semibold",facilities:"bg-indigo-50 text-indigo-600 font-semibold"},s="text-gray-600 hover:bg-gray-100 hover:text-gray-900 hover:-translate-y-px";c.useEffect(()=>{const d=y=>{b.current&&!b.current.contains(y.target)&&o(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const a=d=>{m(d),u(!1)};return e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-40",children:[e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"FlexSpace Pro"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-2",children:[e.jsxs("button",{onClick:()=>a("dashboard"),className:`${r} ${t==="dashboard"?l.dashboard:s}`,children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{children:"대시보드 / Dashboard"})]}),e.jsxs("button",{onClick:()=>a("booking"),className:`${r} ${t==="booking"?l.booking:s}`,children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"체육관 대관 / Booking"})]}),e.jsxs("button",{onClick:()=>a("program"),className:`${r} ${t==="program"?l.program:s}`,children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:"프로그램 / Program"})]}),n.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a("admin"),className:`${r} ${t==="admin"?l.admin:s}`,children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"운영 관리 / Operations"})]}),e.jsxs("button",{onClick:()=>a("facilities"),className:`${r} ${t==="facilities"?l.facilities:s}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"시설 관리 / Facilities"})]}),e.jsxs("button",{onClick:()=>a("userManagement"),className:`${r} ${t==="userManagement"?l.userManagement:s}`,children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:"회원 관리 / Users"})]})]})]}),e.jsx("button",{onClick:()=>u(!h),className:"md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:h?e.jsx(M,{className:"w-5 h-5"}):e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",ref:b,children:[e.jsxs("button",{onClick:()=>o(!x),className:"flex items-center space-x-2 cursor-pointer p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("span",{className:"text-sm text-gray-600 font-medium hidden sm:block",children:[n.name," (",n.role==="admin"?"관리자":"사용자",")"]}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-gray-600",children:n.name.charAt(0).toUpperCase()})]}),x&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 origin-top-right animate-on-load",style:{animationName:"fadeInUp",animationDuration:"0.2s"},children:e.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu",children:[e.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 border-b",children:[e.jsx("p",{className:"font-semibold",children:n.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:n.email})]}),e.jsxs("div",{className:"py-1",children:[e.jsx(F,{}),e.jsxs("button",{onClick:i,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",role:"menuitem",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"로그아웃 / Logout"]})]})]})})]})]}),h&&e.jsx("div",{className:"md:hidden bg-white border-b border-gray-200",children:e.jsxs("div",{className:"px-4 py-2 space-y-1",children:[e.jsxs("button",{onClick:()=>a("dashboard"),className:`w-full text-left ${r} ${t==="dashboard"?l.dashboard:s}`,children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{children:"대시보드 / Dashboard"})]}),e.jsxs("button",{onClick:()=>a("booking"),className:`w-full text-left ${r} ${t==="booking"?l.booking:s}`,children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"체육관 대관 / Booking"})]}),e.jsxs("button",{onClick:()=>a("program"),className:`w-full text-left ${r} ${t==="program"?l.program:s}`,children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:"프로그램 / Program"})]}),n.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a("admin"),className:`w-full text-left ${r} ${t==="admin"?l.admin:s}`,children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"운영 관리 / Operations"})]}),e.jsxs("button",{onClick:()=>a("facilities"),className:`w-full text-left ${r} ${t==="facilities"?l.facilities:s}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"시설 관리 / Facilities"})]}),e.jsxs("button",{onClick:()=>a("userManagement"),className:`w-full text-left ${r} ${t==="userManagement"?l.userManagement:s}`,children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:"회원 관리 / Users"})]})]})]})})]})};export{J as default};
