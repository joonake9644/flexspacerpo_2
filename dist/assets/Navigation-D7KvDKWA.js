import{r as c,j as e}from"./react-C1G-q6RG.js";import{v as b,w as f}from"./firebase-C3mMOVup.js";import{c as j,B as w,d as y,U as g,H as N,e as v,f as k,S,g as C,h as $}from"./icons-CN_tAE-L.js";const B=f();function O(s){const t="=".repeat((4-s.length%4)%4),a=(s+t).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(a),m=new Uint8Array(r.length);for(let n=0;n<r.length;++n)m[n]=r.charCodeAt(n);return m}const P=b(B,"subscribeToPush");function E(){const[s,t]=c.useState(!1),[a,r]=c.useState(!1),[m,n]=c.useState(null),[x,i]=c.useState(null),[d,l]=c.useState(!0);return c.useEffect(()=>{"serviceWorker"in navigator&&"PushManager"in window?(t(!0),navigator.serviceWorker.ready.then(o=>{o.pushManager.getSubscription().then(u=>{u&&(r(!0),n(u)),l(!1)})})):l(!1)},[]),{isSupported:s,isSubscribed:a,subscription:m,subscribe:async()=>{if(!s){i(new Error("?몄떆 ?뚮┝??吏?먮릺吏 ?딅뒗 釉뚮씪?곗??낅땲??"));return}try{const o=await navigator.serviceWorker.register("/sw.js"),u="BPUSPTkxzpJSvhJ4krhwlP0K6U0p_B9xJ3fSgyDWpb4VdbceR571GFI9eOH4tgh4I64IXO9ZywTS4ihtabf1z_8",p=await o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:O(u)});return await P({subscription:p.toJSON()}),n(p),r(!0),i(null),p}catch(o){throw console.error("?몄떆 援щ룆 ?ㅽ뙣:",o),i(o),o}},error:x,loading:d}}const I=()=>{const{isSubscribed:s,subscribe:t,loading:a,error:r}=E();return a?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 flex items-center",disabled:!0,children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"알림 상태 확인 중..."]}):s?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 flex items-center",disabled:!0,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"알림이 활성화되었습니다"]}):r?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-700 flex items-center",disabled:!0,children:[e.jsx(XCircle,{className:"w-4 h-4 mr-2"}),"알림을 활성화할 수 없습니다"]}):e.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"알림 활성화하기"]})},F=({currentUser:s,activeTab:t,setActiveTab:a,onLogout:r})=>{const[m,n]=c.useState(!1),x=c.useRef(null),i="flex items-center space-x-2 px-3 py-2 rounded-lg transition-all duration-200",d={dashboard:"bg-blue-50 text-blue-600 font-semibold",booking:"bg-blue-50 text-blue-600 font-semibold",program:"bg-purple-50 text-purple-600 font-semibold",admin:"bg-green-50 text-green-600 font-semibold",userManagement:"bg-yellow-50 text-yellow-700 font-semibold",facilities:"bg-indigo-50 text-indigo-600 font-semibold"},l="text-gray-600 hover:bg-gray-100 hover:text-gray-900 hover:-translate-y-px";return c.useEffect(()=>{const h=o=>{x.current&&!x.current.contains(o.target)&&n(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"FlexSpace Pro"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-2",children:[e.jsxs("button",{onClick:()=>a("dashboard"),className:`${i} ${t==="dashboard"?d.dashboard:l}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"대시보드 / Dashboard"})]}),e.jsxs("button",{onClick:()=>a("booking"),className:`${i} ${t==="booking"?d.booking:l}`,children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:"체육관 대관 / Booking"})]}),e.jsxs("button",{onClick:()=>a("program"),className:`${i} ${t==="program"?d.program:l}`,children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"프로그램 / Program"})]}),s.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a("admin"),className:`${i} ${t==="admin"?d.admin:l}`,children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"운영 관리 / Operations"})]}),e.jsxs("button",{onClick:()=>a("facilities"),className:`${i} ${t==="facilities"?d.facilities:l}`,children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:"시설 관리 / Facilities"})]}),e.jsxs("button",{onClick:()=>a("userManagement"),className:`${i} ${t==="userManagement"?d.userManagement:l}`,children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:"회원 관리 / Users"})]})]})]})]}),e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{onClick:()=>n(!m),className:"flex items-center space-x-2 cursor-pointer p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("span",{className:"text-sm text-gray-600 font-medium hidden sm:block",children:[s.name," (",s.role==="admin"?"관리자":"사용자",")"]}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-gray-600",children:s.name.charAt(0).toUpperCase()})]}),m&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 origin-top-right animate-on-load",style:{animationName:"fadeInUp",animationDuration:"0.2s"},children:e.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu",children:[e.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 border-b",children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.email})]}),e.jsxs("div",{className:"py-1",children:[e.jsx(I,{}),e.jsxs("button",{onClick:r,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",role:"menuitem",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"로그아웃 / Logout"]})]})]})})]})]})})};export{F as default};
