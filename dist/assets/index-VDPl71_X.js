const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DashboardCalendar-DPNPSWad.js","./react-C1G-q6RG.js","./icons-DJqNYe3e.js","./LoginForm-CFucpcKy.js","./firebase-CpY9aKCX.js","./Navigation-Blw0GNS2.js","./BookingSection-DGHRnudj.js","./firebase-functions-ByRxjYJr.js","./ProgramSection-DYvHYqYS.js","./AdminSection-CCClemEI.js","./UserManagement-IoFBULGp.js","./FacilityManagement-CCs-qidL.js"])))=>i.map(i=>d[i]);
import{r as l,j as e,R as le,a as ce}from"./react-C1G-q6RG.js";import{g as W,i as de,a as ue,b as me,c as he,d as ge,e as xe,f as pe,h as fe,j as we,o as ye,s as K,k as $,l as T,m as L,n as B,p as je,u as X,q as C,r as P,G as be,t as Ne,v as I,w as R,x as F,y as z}from"./firebase-CpY9aKCX.js";import{C as G,U as Q,B as q,a as H,X as ve,I as Ee,T as Ae,b as _e,c as De}from"./icons-DJqNYe3e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))d(u);new MutationObserver(u=>{for(const m of u)if(m.type==="childList")for(const h of m.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&d(h)}).observe(document,{childList:!0,subtree:!0});function i(u){const m={};return u.integrity&&(m.integrity=u.integrity),u.referrerPolicy&&(m.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?m.credentials="include":u.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function d(u){if(u.ep)return;u.ep=!0;const m=i(u);fetch(u.href,m)}})();const Se="modulepreload",Pe=function(t,r){return new URL(t,r).href},Z={},D=function(r,i,d){let u=Promise.resolve();if(i&&i.length>0){let j=function(x){return Promise.all(x.map(n=>Promise.resolve(n).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};const h=document.getElementsByTagName("link"),g=document.querySelector("meta[property=csp-nonce]"),f=g?.nonce||g?.getAttribute("nonce");u=j(i.map(x=>{if(x=Pe(x,d),x in Z)return;Z[x]=!0;const n=x.endsWith(".css"),c=n?'[rel="stylesheet"]':"";if(!!d)for(let s=h.length-1;s>=0;s--){const w=h[s];if(w.href===x&&(!n||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${c}`))return;const o=document.createElement("link");if(o.rel=n?"stylesheet":Se,n||(o.as="script"),o.crossOrigin="",o.href=x,f&&o.setAttribute("nonce",f),document.head.appendChild(o),n)return new Promise((s,w)=>{o.addEventListener("load",s),o.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${x}`)))})}))}function m(h){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=h,window.dispatchEvent(g),!g.defaultPrevented)throw h}return u.then(h=>{for(const g of h||[])g.status==="rejected"&&m(g.reason);return r().catch(m)})},O={},Te={apiKey:"AIzaSyBvlPy3BOyrRCokGAHkzuX6IoVZNjWTU-0",authDomain:"flexspaceprowin.firebaseapp.com",projectId:"flexspaceprowin",storageBucket:"flexspaceprowin.firebasestorage.app",messagingSenderId:"545144229496",appId:"1:545144229496:web:a833b961cf4b8a7ce9678d",measurementId:"G-D81Q76VKZQ"},M=W().length?W()[0]:de(Te),y=ue(M),v=me(M),te=he(M),Le=O?.VITE_USE_EMULATOR==="true";if(Le){const t=O?.VITE_EMULATOR_HOST||"127.0.0.1",r=Number(O?.VITE_EMULATOR_AUTH_PORT||9099),i=Number(O?.VITE_EMULATOR_FIRESTORE_PORT||8080),d=Number(O?.VITE_EMULATOR_STORAGE_PORT||9199);try{ge(y,`http://${t}:${r}`,{disableWarnings:!0})}catch{}try{xe(v,t,i)}catch{}try{pe(te,t,d)}catch{}}fe().then(t=>t?we(M):null).catch(()=>null);const et=Object.freeze(Object.defineProperty({__proto__:null,auth:y,db:v,default:M,storage:te},Symbol.toStringTag,{value:"Module"})),Ce=()=>{const[t,r]=l.useState(null),[i,d]=l.useState(!1),[u,m]=l.useState(!0);l.useEffect(()=>{m(!0);const a=ye(y,async o=>{try{if(!o){r(null),d(!1);return}d(o.emailVerified);const s=L(v,"users",o.uid),w=await B(s);let b="user",p=o.displayName||(o.email?.split("@")[0]??"user"),_;if(w.exists()){const N=w.data();b=N.role||"user",p=N.name||p,_=N.phone}else{const N={name:p,email:o.email??"",phone:null,role:"user",isActive:!0,createdAt:P(),updatedAt:P()};await C(s,N),console.log("새 사용자 정보를 users 컬렉션에 추가:",o.uid)}r({id:o.uid,name:p,email:o.email??"",phone:_,role:b})}catch(s){console.error("Auth state change error:",s),o&&r({id:o.uid,name:o.email?.split("@")[0]??"user",email:o.email??"",role:"user"})}finally{m(!1)}});return()=>a()},[]);const h=l.useCallback(async(a,o)=>{try{const s=await K(y,a,o);if(!s.user.emailVerified){try{await $(s.user,{url:`${window.location.origin}/`,handleCodeInApp:!1})}catch(w){console.warn("이메일 인증 재전송 실패:",w)}throw await T(y),new Error("이메일 인증이 필요합니다. 새로운 인증 메일을 발송했습니다. 이메일함을 확인해주세요.")}return!0}catch(s){throw console.error("Login error:",s),s}},[]),g=l.useCallback(async(a,o)=>{try{const s=await K(y,a,o);if(!(a==="admin@flexspace.test"||a==="flexadmin@test.com"||a==="joonake@naver.com")&&!s.user.emailVerified){try{await $(s.user,{url:`${window.location.origin}/`,handleCodeInApp:!1})}catch(V){console.warn("관리자 이메일 인증 재전송 실패:",V)}throw await T(y),new Error("이메일 인증이 필요합니다. 새로운 인증 메일을 발송했습니다. 이메일함을 확인해주세요.")}const b=L(v,"users",s.user.uid),p=await B(b),_=p.exists()?p.data():{},N=_.role;if(console.log("Admin login - User data:",{uid:s.user.uid,email:s.user.email,firestoreExists:p.exists(),role:N,allData:_}),N!=="admin")throw await T(y),new Error(`관리자 권한이 없습니다. 현재 권한: ${N||"없음"}`);return!0}catch(s){throw console.error("Admin login error:",s),s}},[]),f=l.useCallback(async a=>{try{const{name:o,email:s,phone:w,password:b}=a;if(!s||!b)throw new Error("이메일과 비밀번호가 필요합니다.");if(b.length<6)throw new Error("비밀번호는 6자 이상이어야 합니다.");const p=await je(y,s,b);await X(p.user,{displayName:o||s.split("@")[0]});const _=L(v,"users",p.user.uid);await C(_,{name:o||(s.split("@")[0]??"user"),email:s,phone:w||null,role:"user",isActive:!0,createdAt:P(),updatedAt:P()},{merge:!0});try{await $(p.user,{url:`${window.location.origin}/`,handleCodeInApp:!1}),console.log("이메일 인증 메일 전송 성공:",s)}catch(N){console.warn("이메일 인증 메일 전송 실패:",N)}return await T(y),!0}catch(o){throw console.error("Signup error:",o),o}},[]),j=l.useCallback(async()=>{try{const a=new be;a.addScope("email"),a.addScope("profile"),a.setCustomParameters({prompt:"select_account"});const s=(await Ne(y,a)).user;if(console.log("Google login success:",{uid:s.uid,email:s.email,displayName:s.displayName,emailVerified:s.emailVerified}),!s.email)throw new Error("Google 계정에서 이메일 정보를 가져올 수 없습니다.");const w=L(v,"users",s.uid);let b={name:s.displayName||s.email.split("@")[0]||"user",email:s.email,phone:s.phoneNumber||null,role:"user",isActive:!0,updatedAt:P()};try{(await B(w)).exists()?(await C(w,b,{merge:!0}),console.log("Google 로그인: 기존 사용자 정보 업데이트됨:",s.uid)):(await C(w,{...b,createdAt:P()}),console.log("Google 로그인: 새 사용자 정보 저장됨:",s.uid))}catch(p){console.warn("Firestore 저장 실패, 하지만 로그인은 계속 진행:",p)}return!0}catch(a){throw console.error("Google login error:",a),a.code==="auth/popup-closed-by-user"||a.code==="auth/cancelled-popup-request"?new Error("Google 로그인이 취소되었습니다."):a.code==="auth/popup-blocked"?new Error("팝업이 차단되었습니다. 브라우저 설정에서 팝업을 허용해주세요."):a.code==="auth/network-request-failed"?new Error("네트워크 연결을 확인해주세요."):new Error(`Google 로그인 실패: ${a.message||"알 수 없는 오류"}`)}},[]),x=l.useCallback(async()=>{if(y.currentUser)return await $(y.currentUser),!0;throw new Error("로그인이 필요합니다.")},[]),n=l.useCallback(async(a,o)=>{if(y.currentUser){await X(y.currentUser,{displayName:a,photoURL:o});const s=L(v,"users",y.currentUser.uid);return await C(s,{name:a||y.currentUser.displayName,updatedAt:P()},{merge:!0}),!0}throw new Error("로그인이 필요합니다.")},[]),c=l.useCallback(async()=>{await T(y),r(null),d(!1)},[]);return l.useMemo(()=>({user:t,login:h,logout:c,signup:f,adminLogin:g,googleLogin:j,sendVerificationEmail:x,updateUserProfile:n,emailVerified:i,loading:u}),[t,h,c,f,g,j,x,n,i,u])},Ie=()=>{const[t,r]=l.useState(!0),[i,d]=l.useState([]),[u,m]=l.useState([]),[h,g]=l.useState([]),[f,j]=l.useState([]),[x,n]=l.useState([]);return l.useEffect(()=>{const c=[];return c.push(I(R(v,"users"),a=>{const o=a.docs.map(s=>({id:s.id,...s.data()}));j(o)},a=>{console.error("Error fetching users:",a)})),c.push(I(F(R(v,"bookings"),z("createdAt","desc")),a=>{const o=a.docs.map(s=>({id:s.id,...s.data()}));d(o)},a=>{console.error("Error fetching bookings:",a)})),c.push(I(F(R(v,"programs"),z("startDate","asc")),a=>{const o=a.docs.map(s=>({id:s.id,...s.data()}));m(o)},a=>{console.error("Error fetching programs:",a)})),c.push(I(F(R(v,"applications"),z("appliedAt","desc")),a=>{const o=a.docs.map(s=>({id:s.id,...s.data()}));g(o)},a=>{console.error("Error fetching applications:",a)})),c.push(I(R(v,"facilities"),a=>{const o=a.docs.map(s=>({id:s.id,...s.data()}));n(o)},a=>{console.error("Error fetching facilities:",a)})),r(!1),()=>c.forEach(a=>a())},[]),l.useMemo(()=>({loading:t,bookings:i,setBookings:d,programs:u,setPrograms:m,applications:h,setApplications:g,users:f,setUsers:j,facilities:x}),[t,i,u,h,f,x])},tt=t=>{const r=t.replace(/\D/g,"");return r.length<=3?r:r.length<=7?`${r.slice(0,3)}-${r.slice(3)}`:`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7,11)}`},U=t=>({"auth/user-not-found":"미가입자입니다. 회원가입을 해주세요.","auth/wrong-password":"비밀번호가 일치하지 않습니다.","auth/email-already-in-use":"이미 사용 중인 이메일입니다.","auth/weak-password":"비밀번호가 너무 간단합니다. 6자 이상 입력해주세요.","auth/invalid-email":"올바른 이메일 형식이 아닙니다.","auth/invalid-credential":"이메일 또는 비밀번호가 잘못되었습니다. 미가입자는 회원가입을 먼저 해주세요.","auth/invalid-login-credentials":"로그인 정보가 잘못되었습니다. 미가입자는 회원가입을 먼저 해주세요.","auth/too-many-requests":"로그인 시도가 너무 많습니다. 잠시 후 다시 시도하거나 브라우저 캐시를 삭제해 주세요.","firestore/permission-denied":"접근 권한이 없습니다.","firestore/unavailable":"서비스가 일시적으로 사용 불가합니다.","firestore/deadline-exceeded":"요청 시간이 초과되었습니다.","storage/unauthorized":"파일 업로드 권한이 없습니다.","storage/object-not-found":"파일을 찾을 수 없습니다.","storage/quota-exceeded":"저장소 용량이 초과되었습니다.","functions/permission-denied":"함수 실행 권한이 없습니다.","functions/unavailable":"서버 함수가 일시적으로 사용 불가합니다."})[t]||"로그인에 실패했습니다. 이메일/비밀번호를 확인하거나 회원가입을 먼저 진행해주세요.",k=t=>{const r=t instanceof Error?t.message:String(t),i=r.match(/auth\/([\w-]+)/);return i&&i[0]?U(i[0]):U(r)},Re=l.lazy(()=>D(()=>import("./DashboardCalendar-DPNPSWad.js"),__vite__mapDeps([0,1,2]),import.meta.url)),Oe=t=>{const r=new Date;r.setHours(0,0,0,0);const i=new Date(t.startDate);i.setHours(0,0,0,0);const d=new Date(t.endDate);return d.setHours(0,0,0,0),r>d?{text:"종료",dDay:null}:r>=i&&r<=d?{text:"진행중",dDay:null}:{text:"모집중",dDay:Math.ceil((i.getTime()-r.getTime())/(1e3*60*60*24))}},J=({status:t})=>{const r={approved:{text:"승인됨 / Approved",color:"bg-green-100 text-green-800"},pending:{text:"대기중 / Pending",color:"bg-orange-100 text-orange-800"},rejected:{text:"거절됨 / Rejected",color:"bg-red-100 text-red-800"},completed:{text:"종료 / Ended",color:"bg-gray-100 text-gray-800"},cancelled:{text:"취소됨 / Cancelled",color:"bg-gray-100 text-gray-800"}},{text:i,color:d}=r[t];return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d}`,children:i})},se=["일","월","화","수","목","금","토"],Me=t=>{const{startDate:r,endDate:i,recurrenceRule:d}=t;if(r===i)return r;let u="";return d&&d.days.length>0&&(u=` (매주 / Every ${d.days.sort().map(m=>se[m]).join(", ")})`),`${r} ~ ${i}${u}`},$e=t=>`${t.scheduleDays.sort().map(i=>se[i]).join(",")} ${t.startTime}-${t.endTime}`,Y=({currentUser:t,bookings:r=[],applications:i=[],programs:d=[],setActiveTab:u})=>{const m=l.useMemo(()=>r.filter(n=>n.userId===t.id).sort((n,c)=>new Date(c.startDate).getTime()-new Date(n.startDate).getTime()),[r,t.id]),h=l.useMemo(()=>i.filter(n=>n.userId===t.id).sort((n,c)=>{const a=n.appliedAt?.toDate?n.appliedAt.toDate():new Date(n.appliedAt||0);return(c.appliedAt?.toDate?c.appliedAt.toDate():new Date(c.appliedAt||0)).getTime()-a.getTime()}),[i,t.id]),g=l.useMemo(()=>r.filter(n=>n.status==="pending"),[r]),f=l.useMemo(()=>i.filter(n=>n.status==="pending"),[i]),[j,x]=l.useState("month");return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:t.role==="admin"?"관리자 대시보드 / Admin Dashboard":"마이 대시보드 / My Dashboard"}),e.jsx("p",{className:"text-gray-600",children:t.role==="admin"?"체육관 운영 현황을 한눈에 확인하세요 / Check gym operational status at a glance":"나의 예약과 프로그램 신청 현황입니다 / View your booking and program application status"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:t.role==="admin"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"대기중인 대관 / Pending Bookings"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:g.length})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center",children:e.jsx(G,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"대기중인 프로그램 신청 / Pending Applications"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:f.length})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"운영중인 프로그램 / Active Programs"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:d.filter(n=>{const c=new Date;return new Date(n.endDate)>=c}).length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"총 이용자 수 / Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:"128"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-blue-600"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"나의 대관 / My Bookings"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:m.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"나의 프로그램 신청 / My Applications"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:h.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"운영중인 프로그램 / Active Programs"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:d.length})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"최근 대관 신청 / Recent Bookings"}),e.jsxs("div",{className:"space-y-4",children:[(t.role==="admin"?r.slice(0,3):m.slice(0,3)).map(n=>e.jsx("div",{className:"p-4 bg-gray-50 rounded-xl transition-colors duration-200 hover:bg-gray-100 border-l-4 border-blue-500",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.purpose}),e.jsx(J,{status:n.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),n.organization&&`${n.organization} | `,Me(n)," ",n.startTime,"-",n.endTime]}),t.role==="admin"&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"신청자: ",n.userName," (",n.userEmail,")"]}),e.jsxs("p",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(q,{className:"w-4 h-4"}),n.category==="class"?"수업":n.category==="event"?"행사":n.category==="personal"?"개인":"동아리"," | ",n.numberOfParticipants,"명"]})]})]})})},n.id)),(t.role==="admin"?r:m).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"대관 신청 내역이 없습니다."})]}),(t.role==="admin"?r:m).length>3&&e.jsx("button",{onClick:()=>u("booking"),className:"w-full mt-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"전체 보기"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t.role==="admin"?"프로그램 신청 현황 / Program Applications":"내 프로그램 / My Programs"}),e.jsxs("div",{className:"space-y-4",children:[(t.role==="admin"?i.slice(0,3):h.slice(0,3)).map(n=>{const c=d.find(o=>o.id===n.programId),a=c?Oe(c):null;return e.jsx("div",{className:"p-4 bg-gray-50 rounded-xl transition-colors duration-200 hover:bg-gray-100 border-l-4 border-purple-500",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.programTitle}),a&&a.dDay!==null&&e.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-full",children:["D-",a.dDay]}),e.jsx(J,{status:n.status})]}),c&&e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"강사: ",c.instructor," | 기간: ",c.startDate," ~ ",c.endDate]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"일정: ",$e(c)]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"비용: ",c.fee?`${c.fee.toLocaleString()}원`:"무료"," | 정원: ",c.enrolled??0," / ",c.capacity,"명"]})]}),t.role==="admin"&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"신청자: ",n.userName," | 신청일: ",(n.appliedAt?.toDate?n.appliedAt.toDate():new Date(n.appliedAt||0)).toLocaleDateString()]})]})})},n.id)}),(t.role==="admin"?i:h).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"프로그램 신청 내역이 없습니다."})]}),(t.role==="admin"?i:h).length>3&&e.jsx("button",{onClick:()=>u("program"),className:"w-full mt-4 py-2 text-sm font-medium text-purple-600 hover:text-purple-800 transition-colors",children:"전체 보기"})]})]}),e.jsxs("div",{id:"dashboard-calendar-section",className:"mt-6 bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"전체 일정 캘린더 / Full Schedule Calendar"}),e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"text-gray-500",children:"캘린더 로딩 중..."}),children:e.jsx(Re,{bookings:t.role==="admin"?r:m,programs:d,view:j,setView:x})})]})]})},re=l.createContext(void 0),ke=({children:t})=>{const[r,i]=l.useState([]),d=l.useCallback(m=>{i(h=>h.filter(g=>g.id!==m))},[]),u=l.useCallback((m,h="info",g=5e3)=>{const f=`notification-${Date.now()}-${Math.random()}`,j={id:f,message:m,type:h,duration:g};i(x=>[...x,j]),g>0&&setTimeout(()=>{d(f)},g)},[d]);return e.jsx(re.Provider,{value:{notifications:r,showNotification:u,removeNotification:d},children:t})},Ve=()=>{const t=l.useContext(re);if(t===void 0)throw new Error("useNotification must be used within a NotificationProvider");return t},Be={success:e.jsx(De,{className:"w-6 h-6 text-green-500"}),error:e.jsx(_e,{className:"w-6 h-6 text-red-500"}),warning:e.jsx(Ae,{className:"w-6 h-6 text-yellow-500"}),info:e.jsx(Ee,{className:"w-6 h-6 text-blue-500"})},Fe=({notification:t,onRemove:r})=>e.jsx("div",{className:"bg-white rounded-xl shadow-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden mb-4 animate-on-load",style:{animationName:"fadeInRight"},children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:Be[t.type]}),e.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.message})}),e.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:e.jsxs("button",{onClick:()=>r(t.id),className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(ve,{className:"h-5 w-5","aria-hidden":"true"})]})})]})})}),ze=()=>{const{notifications:t,removeNotification:r}=Ve();return e.jsx("div",{className:"fixed inset-0 flex items-end justify-end px-4 py-6 pointer-events-none sm:p-6 z-50",children:e.jsx("div",{className:"w-full max-w-sm",children:t.map(i=>e.jsx(Fe,{notification:i,onRemove:r},i.id))})})},Ge=l.lazy(()=>D(()=>import("./LoginForm-CFucpcKy.js"),__vite__mapDeps([3,1,4,2]),import.meta.url)),qe=l.lazy(()=>D(()=>import("./Navigation-Blw0GNS2.js"),__vite__mapDeps([5,1,4,2]),import.meta.url)),He=l.lazy(()=>D(()=>import("./BookingSection-DGHRnudj.js"),__vite__mapDeps([6,1,4,7,2]),import.meta.url)),We=l.lazy(()=>D(()=>import("./ProgramSection-DYvHYqYS.js"),__vite__mapDeps([8,1,4,7,2]),import.meta.url)),Ke=l.lazy(()=>D(()=>import("./AdminSection-CCClemEI.js"),__vite__mapDeps([9,1,4,7,2]),import.meta.url)),Xe=l.lazy(()=>D(()=>import("./UserManagement-IoFBULGp.js"),__vite__mapDeps([10,1,4,2]),import.meta.url)),Qe=l.lazy(()=>D(()=>import("./FacilityManagement-CCs-qidL.js"),__vite__mapDeps([11,1,4,2]),import.meta.url));function Ze(){const{user:t,login:r,logout:i,signup:d,adminLogin:u,googleLogin:m,loading:h}=Ce(),{loading:g,bookings:f,setBookings:j,programs:x,setPrograms:n,applications:c,setApplications:a,users:o,setUsers:s,facilities:w}=Ie(),[b,p]=l.useState("dashboard");l.useEffect(()=>{t&&!g&&p("dashboard")},[t,g]);const _=async(E,A)=>{try{if(!E.trim()||!A.trim())throw new Error("이메일과 비밀번호를 입력해주세요.");return await r(E,A),[!0,null]}catch(S){return console.error("Login failed:",S),[!1,k(S)]}},N=async(E,A)=>{try{if(!E.trim()||!A.trim())throw new Error("이메일과 비밀번호를 입력해주세요.");return await u(E,A),[!0,null]}catch(S){return console.error("Admin login failed:",S),[!1,k(S)]}},V=async E=>{try{const{name:A,email:S,password:ie}=E;if(!A?.trim())throw new Error("이름을 입력해주세요.");if(!S?.trim())throw new Error("이메일을 입력해주세요.");if(!ie?.trim())throw new Error("비밀번호를 입력해주세요.");return await d(E),[!0,"회원가입이 완료되었습니다. 이메일 인증을 확인해주세요."]}catch(A){return console.error("Signup failed:",A),[!1,k(A)]}},ae=async()=>{try{return await m(),[!0,null]}catch(E){return console.error("Google login failed:",E),[!1,k(E)]}},ne=async()=>{await i(),p("dashboard")},oe=()=>{if(!t)return null;switch(b){case"dashboard":return e.jsx(Y,{currentUser:t,bookings:f,applications:c,programs:x,setActiveTab:p});case"booking":return e.jsx(He,{currentUser:t,bookings:f,setBookings:j});case"program":return e.jsx(We,{currentUser:t,programs:x,setPrograms:n,applications:c,setApplications:a});case"admin":return e.jsx(Ke,{currentUser:t,bookings:f,setBookings:j,applications:c,setApplications:a,programs:x,setPrograms:n,users:o,facilities:w});case"userManagement":return e.jsx(Xe,{users:o,setUsers:s});case"facilities":return e.jsx(Qe,{});default:return e.jsx(Y,{currentUser:t,bookings:f,applications:c,programs:x,setActiveTab:p})}};return g||h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{}),e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}),children:t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(qe,{currentUser:t,activeTab:b,setActiveTab:p,onLogout:ne}),e.jsx("main",{children:oe()})]}):e.jsx(Ge,{onLogin:_,onSignup:V,onAdminLogin:N,onGoogleLogin:ae})})]})}const ee=document.getElementById("root");ee?le.createRoot(ee).render(e.jsx(ce.StrictMode,{children:e.jsx(ke,{children:e.jsx(Ze,{})})})):console.error("Failed to find the root element");export{D as _,y as a,Ie as b,M as c,v as d,et as e,tt as f,k as g,Ve as u};
